/**
 * 日本人名生成システム
 * 姓 + 名の組み合わせ
 */

/** 姓（苗字）- 日本の一般的な姓500種以上から抜粋 */
export const SURNAMES = [
    // 上位30
    '佐藤', '鈴木', '高橋', '田中', '伊藤', '渡辺', '山本', '中村', '小林', '加藤',
    '吉田', '山田', '佐々木', '山口', '松本', '井上', '木村', '林', '斎藤', '清水',
    '山崎', '池田', '橋本', '阿部', '石川', '森', '前田', '藤田', '小川', '岡田',
    // 31-60
    '後藤', '長谷川', '石井', '村上', '近藤', '坂本', '遠藤', '青木', '藤井', '西村',
    '福田', '太田', '三浦', '岡本', '松田', '中川', '中野', '原田', '竹内', '金子',
    '和田', '中山', '石田', '上田', '森田', '原', '柴田', '酒井', '工藤', '横山',
    // 61-100
    '宮崎', '宮本', '内田', '高木', '安藤', '谷口', '大野', '丸山', '今井', '河野',
    '藤原', '小野', '田村', '中島', '平野', '久保', '永井', '山下', '菅原', '新井',
    '市川', '小山', '武田', '上野', '杉山', '増田', '平田', '小島', '土屋', '野村',
    '大塚', '千葉', '菊地', '川村', '岩崎', '久保田', '野口', '松井', '渡部', '桜井',
    // 101-150
    '菊池', '佐野', '杉本', '古川', '水野', '岩田', '渋谷', '星野', '横田', '大島',
    '浜田', '大西', '川口', '服部', '堀', '関', '矢野', '上原', '北村', '川崎',
    '吉川', '松尾', '本田', '須藤', '西田', '五十嵐', '田口', '落合', '秋山', '飯田',
    '村田', '小池', '中田', '吉村', '南', '浅野', '奥村', '野田', '石原', '川上',
    '福島', '早川', '望月', '高田', '内藤', '山内', '荒木', '黒田', '安田', '宮田',
];

/** 男性名 */
export const MALE_NAMES = [
    // 伝統的な名前
    '太郎', '一郎', '次郎', '三郎', '健一', '浩', '誠', '豊', '修', '茂',
    '隆', '正', '博', '武', '明', '進', '勇', '清', '実', '功',
    // 現代的な名前
    '大輔', '翔太', '拓也', '直樹', '和也', '達也', '健太', '雄介', '慎一', '智也',
    '裕介', '康平', '翔', '蓮', '悠斗', '陽太', '颯太', '大翔', '湊', '朝陽',
    '優斗', '樹', '海斗', '陽翔', '蒼', '律', '陽向', '結翔', '暖', '新',
    // ビジネス系
    '英樹', '正行', '幸司', '信也', '良太', '俊介', '啓介', '康弘', '秀樹', '雅彦',
    '光男', '敏夫', '和夫', '義男', '正雄', '文雄', '幸雄', '一男', '弘', '剛',
    // 知的系
    '哲也', '賢一', '智之', '学', '研', '聡', '賢', '理', '悟', '敬',
];

/** 女性名 */
export const FEMALE_NAMES = [
    // 伝統的な名前
    '花子', '幸子', '和子', '洋子', '美代子', '恵子', '京子', '節子', '正子', '栄子',
    '文子', '光子', '芳子', '千代子', '君子', '典子', '久子', '富子', '良子', '敏子',
    // 現代的な名前
    '美咲', 'さくら', '陽菜', '結衣', '葵', '凛', '杏', '楓', '結菜', '心春',
    '紬', '莉子', '芽依', '詩', '彩花', '美月', '七海', '琴音', '花音', '陽葵',
    '真央', '優花', '愛', '舞', '彩', '萌', '碧', '楓', '桜', '美優',
    // ビジネス系
    '由美', '恵美', '裕子', '智子', '明美', '直美', '真理', '純子', '香', '彩香',
    '麻衣', '早紀', '沙織', '瞳', '綾', '茜', '梨花', '奈々', '千尋', '麻美',
    // 知的系
    '聡子', '理恵', '知恵', '佐知子', '英子', '史子', '雅子', '貴子', '晶子', '慧',
];

/** シード値から再現可能な乱数生成器 */
function seededRandom(seed: number): () => number {
    let state = seed;
    return () => {
        state = (state * 1103515245 + 12345) & 0x7fffffff;
        return state / 0x7fffffff;
    };
}

/** 配列からランダムに選択 */
function pickRandom<T>(array: T[], random: () => number): T {
    return array[Math.floor(random() * array.length)];
}

/** 性別 */
export type Gender = 'M' | 'F' | 'OTHER';

/** 日本人名を生成 */
export function generateJapaneseName(seed: number, gender?: Gender): { name: string; gender: Gender } {
    const random = seededRandom(seed);

    const surname = pickRandom(SURNAMES, random);

    // 性別が指定されていない場合はランダム
    const actualGender = gender || (random() > 0.5 ? 'M' : 'F');

    const firstName = actualGender === 'M'
        ? pickRandom(MALE_NAMES, random)
        : pickRandom(FEMALE_NAMES, random);

    return {
        name: `${surname} ${firstName}`,
        gender: actualGender
    };
}

/** 複数の日本人名を生成（重複なし） */
export function generateJapaneseNames(count: number, baseSeed: number): Array<{ name: string; gender: Gender }> {
    const names = new Map<string, Gender>();
    let seed = baseSeed;

    while (names.size < count) {
        const { name, gender } = generateJapaneseName(seed);
        if (!names.has(name)) {
            names.set(name, gender);
        }
        seed++;
    }

    return Array.from(names.entries()).map(([name, gender]) => ({ name, gender }));
}
